---
title: "R Workshop: Exploratory Data Analysis"
author: "Sara Eftekhar Azam"
date: "2024-05"
---

## Introduction
In this part of the workshop, we are going to use R language to analyze, filter, group, and plot data.

## Loading packages
First, we have to install packages (if not already installed).
The packages we are going to use are tidyverse, ggplot2, dplyr, and magrittr.

tidyverse: This is a collection of R packages designed for data science. It includes some datasets too.

ggplot2: This package is used for creating elegant and complex data visualizations.

dplyr: This package provides a set of functions for data manipulation tasks such as filtering, grouping, summarizing, and mutating data frames.

magrittr: This package provides the pipe operator %>%, which allows you to chain together multiple operations.

To install a package, use install.packages("name of package") in the console or terminal below. You only have to do this once.

install.packages("tidyverse")
install.packages("ggplot2")
install.packages("dplyr")
install.packages("magrittr")


To run a cell, click on the run button.

After installing the packages, we should include or import them to use them later:
```{r import packages}
library(tidyverse)
library(ggplot2)
library(dplyr)
library(magrittr)
```

## Loading data and initial exploring dataset
The packages we are using have many good datasets inside them. We can use them too.
To see their available datasets, run the following chunk:
```{r list datasets}
data(package = "ggplot2")
```
We are going to use mpg dataset for this part of the workshop. 

```{r explore data: head}
# View the first few rows of the dataset
head(mpg)

```
Here is a short description of different columns in this dataset (if you can't find it in the above explanation, search internet for explanation for the dataset):

manufacturer: This column represents the manufacturer or company that produced the car. For example, "audi", "chevrolet", "ford", etc.
model: This column specifies the model name or identifier of the car. It usually refers to the specific make and model of the vehicle, such as "a4", "corvette", "mustang", etc.
displ: The "displ" column stands for engine displacement, which refers to the volume of space in the engine cylinders where combustion occurs. It's typically measured in liters (L) or cubic inches (cu. in.). Engine displacement is an indicator of engine size and power.
year: This column indicates the year the car was manufactured.
cyl: The "cyl" column represents the number of cylinders in the engine. Cars can have different numbers of cylinders, such as 4-cylinder, 6-cylinder, or 8-cylinder engines.
trans: This column specifies the type of transmission in the car, such as automatic or manual. It may also include additional details about the transmission system.
drv: The "drv" column represents the type of drive train, which refers to how power is transmitted from the engine to the wheels. Common drive train types include front-wheel drive (fwd), rear-wheel drive (rwd), and four-wheel drive (4wd).
cty: The "cty" column stands for city mileage, which represents the estimated fuel efficiency of the car in miles per gallon (mpg) when driving in city conditions.
hwy: The "hwy" column represents highway mileage, which indicates the estimated fuel efficiency of the car in miles per gallon (mpg) when driving on the highway.
fl: This column indicates the fuel type used by the car, such as regular gasoline (r), premium gasoline (p), or diesel (d).
class: The "class" column specifies the class or category of the car, such as compact, midsize, or SUV (sport utility vehicle).


```{r explore data: str}
# Display the structure of the dataset
str(mpg)

```


```{r explore data: summary}
# Summary statistics for numerical variables
summary(mpg)

```
## Asignment 1 (max 3 minutes)
For this assignment, we are going to do the same for diamonds dataset.
Load it, and print different summaries and explanation for the dataset.


## Group, filter, and plot data
Grouping in R is like using GROUP BY in SQL.
Filtering in R is like adding conditions with WHERE in SQL.
Plotting is rather simple and intuitive. 

Let's visualize the city and highway mileage (mile per gallon of fuel).
The ggplot library acts in an additive way. You can add more and more to the figure. 
Task: plot city vs highway mileage. Show vehicle class as color. 
```{r visualization}
ggplot(mpg, aes(x = cty, y = hwy, color = class)) +
  geom_point() +  # Add points for each data point
  scale_color_discrete(name = "Vehicle Class") +  # Custom color legend title
  labs(x = "City Mileage (mpg)", y = "Highway Mileage (mpg)") +  # Labels for x and y axes
  ggtitle("Scatter Plot of City Mileage vs. Highway Mileage")  # Title for the plot
```

### Assignment 2: (up to 3 minues)
Using above code as example, create a plot for a diamond carot vs its price and show its cut as color.

We are going to learn how to do these by doing some example tasks.

### Task 1:
Compare the average city mileage for different car manufacturers.
Only consider car that were made after 1999.
Plot bar chart to show the results. 

Let's do this with pipe %>% operator:

```{r task 1, with pipe}
task1 <- mpg %>% 
  filter(year > 1999) %>%
  group_by(manufacturer) %>%
  summarise(mean_city_mileage = mean(cty))

ggplot(task1, aes(x = manufacturer, y = mean_city_mileage)) +
  geom_bar(stat = "identity", fill = "skyblue") +
  labs(x = "Manufacturer", y = "Mean City Mileage") +
  ggtitle("Mean City Mileage by Manufacturer")

```

### Task 2:
Plot city and highway mileage (mile per gallon) in a scatter plot for cars made between 1995 and 2005.

```{r task 2}
task2 = mpg %>% filter(year >= 1995 & year <= 2005)
ggplot(task2, aes(x = cty, y = hwy)) +
  geom_point() +  # Add points
  labs(x = "City Mileage", y = "Highway Mileage") +
  ggtitle("City vs Highway Mileage")

```

# Assignment 3: (up to 5 minutes)
Plot average price of diamonds for each diamond cut for diamonds with carot between 0.5 and 1.5. 
